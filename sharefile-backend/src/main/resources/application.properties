# ==============================
# Application Info
# ==============================
quarkus.application.name=ShareFile Backend
quarkus.application.version=1.0.0

# ==============================
# HTTP Configuration
# ==============================
quarkus.http.port=8081
quarkus.http.cors.origins=http://localhost:4200,http://localhost:3000
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.limits.max-body-size=1G
quarkus.http.body.uploads-directory=${java.io.tmpdir}/uploads
quarkus.http.body.handle-file-uploads=true
quarkus.http.body.delete-uploaded-files-on-end=true
quarkus.http.body.preallocate-body-buffer=false
quarkus.http.auth.basic=false

# ==============================
# Database Configuration (PostgreSQL)
# ==============================
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=${DB_USER:sharefile-db-user}
quarkus.datasource.password=${DB_PASSWORD:sharefile-db-password}
quarkus.datasource.jdbc.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5431}/${DB_NAME:sharefile}

# Hibernate/JPA
quarkus.hibernate-orm.database.generation=update
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.sql-load-script=no-file

# ==============================
# Keycloak OIDC Configuration (Frontend Auth)
# ==============================
quarkus.oidc.auth-server-url=${KEYCLOAK_URL:http://localhost:8080}/realms/${KEYCLOAK_REALM:sharefile}
quarkus.oidc.client-id=${KEYCLOAK_CLIENT_ID:sharefile-backend}
quarkus.oidc.credentials.secret=${KEYCLOAK_CLIENT_SECRET:hkLdrNRfnmHhtx6VTaSueEIycRnUouM8}
quarkus.oidc.tls.verification=none
quarkus.oidc.application-type=service

# ==============================
# Keycloak Admin Configuration
# ==============================
keycloak.server-url=${KEYCLOAK_URL:http://localhost:8080}
keycloak.realm=${KEYCLOAK_REALM:sharefile}
keycloak.admin.username=${KEYCLOAK_ADMIN_USER:sharefile-keycloak-user}
keycloak.admin.password=${KEYCLOAK_ADMIN_PASSWORD:sharefile-keycloak-password}
keycloak.admin.client-id=${KEYCLOAK_ADMIN_CLIENT_ID:admin-cli}
keycloak.admin.connection-pool-size=${KEYCLOAK_POOL_SIZE:10}
keycloak.admin.connection-timeout=${KEYCLOAK_TIMEOUT:60000}

# Email settings
keycloak.email.verification.enabled=${KEYCLOAK_EMAIL_VERIFICATION:true}
keycloak.email.welcome.enabled=${KEYCLOAK_WELCOME_EMAIL:false}


quarkus.mailer.mock=false
quarkus.mailer.timeout=10s
quarkus.mailer.from=streetblack98@gmail.com
quarkus.mailer.host=smtp.gmail.com
quarkus.mailer.port=587
quarkus.mailer.start-tls=REQUIRED
quarkus.mailer.username=streetblack98@gmail.com
quarkus.mailer.password=veav vlan cplr xymt

# ==============================
# JWT & Security
# ==============================
quarkus.security.auth.enabled=true
quarkus.security.auth.mechanism.basic=false
quarkus.security.auth.mechanism.form=false
mp.jwt.verify.publickey.location=${quarkus.oidc.auth-server-url}/protocol/openid-connect/certs
mp.jwt.verify.issuer=${quarkus.oidc.auth-server-url}
quarkus.security.jaxrs.deny-unannotated-endpoints=false
quarkus.transaction-manager.allow-multiple-threads=true



# Filesystem Storage
# ============================================
# AZURE BLOB STORAGE CONFIGURATION
# ============================================

# Connection String (ottenila dal portale Azure)
# Formato: DefaultEndpointsProtocol=https;AccountName=xxx;AccountKey=xxx;EndpointSuffix=core.windows.net
azure.storage.connection-string=${AZURE_STORAGE_CONNECTION_STRING:DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;BlobEndpoint=http://127.0.0.1:10000/devstoreaccount1;}
# Container name (equivalente al bucket S3)
azure.storage.container-name=${AZURE_STORAGE_CONTAINER:sharefile-files}


# ==============================
# File Upload Limits
# ==============================
app.max-file-size-bytes=${MAX_FILE_SIZE_BYTES:1073741824}  # 1GB
app.max-files-per-upload=${MAX_FILES_PER_UPLOAD:10}
app.default-link-expiry-days=${DEFAULT_LINK_EXPIRY_DAYS:7}

# ==============================
# Health Checks
# ==============================
quarkus.smallrye-health.root-path=/health

# ==============================
# Logging Configuration
# ==============================
quarkus.log.level=INFO
quarkus.log.category."com.company.sharefile".level=DEBUG
quarkus.log.category."com.company.sharefile.security".level=DEBUG
quarkus.log.category."com.company.sharefile.service.UserService".level=DEBUG
quarkus.log.category."org.keycloak.admin.client".level=INFO

# Development overrides
%dev.quarkus.log.console.enable=true
%dev.quarkus.log.level=DEBUG
%dev.quarkus.hibernate-orm.log.sql=true
%dev.quarkus.datasource.username=sharefile-db-user
%dev.quarkus.datasource.password=sharefile-db-password
%dev.quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5431/sharefile
%dev.quarkus.live-reload.instrumentation=false
%dev.quarkus.transaction-manager.default-transaction-timeout=300s

# ==============================
# Swagger / OpenAPI
# ==============================
quarkus.swagger-ui.always-include=true
quarkus.swagger-ui.enable=true
quarkus.swagger-ui.path=/swagger-ui
quarkus.smallrye-openapi.info.title=ShareFile API
quarkus.smallrye-openapi.info.version=1.0.0
quarkus.smallrye-openapi.info.description=WeTransfer-like file sharing API for company use
quarkus.smallrye-openapi.info.contact.name=ShareFile Team
quarkus.smallrye-openapi.info.contact.email=dev@company.com
quarkus.smallrye-openapi.security-scheme=jwt

# ==============================
# Performance & Debugging
# ==============================
quarkus.live-reload.instrumentation=false
quarkus.narayana.jta.processing-timeout=60s
quarkus.rest-client.keycloak.url=${KEYCLOAK_URL:http://localhost:8080}